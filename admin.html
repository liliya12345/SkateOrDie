<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Panel | SKATEORDIE.</title>
  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Space+Grotesk:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <!-- Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <!-- CSS Files -->
  <link rel="stylesheet" href="css/style.css">
  <style>
    /* Темная тема для админ панели */
    body {
      background-color: #1a1a1a;
      color: #e0e0e0;
    }

    .admin-header {
      background-color: rgba(26, 26, 26, 0.95);
      border-bottom: 1px solid #333;
      padding: 20px 0;
    }

    .logo {
      color: #ffffff;
    }

    .logo span {
      color: #00ff88;
    }

    .nav-link {
      color: #e0e0e0;
    }

    .nav-link:hover {
      color: #00ff88;
    }

    .nav-link.active {
      color: #00ff88;
    }

    .admin-hero {
      padding-top: 120px;
      padding-bottom: 40px;
      text-align: center;
    }

    .display-md {
      color: #ffffff;
      margin-bottom: 16px;
    }

    .admin-panel-section {
      padding: 40px 0 80px;
    }

    .admin-tabs {
      display: flex;
      gap: 1px;
      background-color: #333;
      border-radius: 8px 8px 0 0;
      overflow: hidden;
      max-width: 800px;
      margin: 0 auto;
    }

    .admin-tab {
      flex: 1;
      padding: 16px;
      background-color: #2a2a2a;
      border: none;
      color: #e0e0e0;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s ease;
      text-align: center;
    }

    .admin-tab:hover {
      background-color: #333;
    }

    .admin-tab.active {
      background-color: #00ff88;
      color: #1a1a1a;
    }

    .admin-content {
      background-color: #2a2a2a;
      border-radius: 0 8px 8px 8px;
      padding: 40px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.4);
      max-width: 800px;
      margin: 0 auto;
      border: 1px solid #333;
      border-top: none;
    }

    .admin-form {
      display: none;
    }

    .admin-form.active {
      display: block;
      animation: fadeIn 0.3s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .form-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 20px;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-label {
      display: block;
      font-size: 0.875rem;
      font-weight: 600;
      margin-bottom: 8px;
      color: #ffffff;
    }

    .form-control {
      width: 100%;
      padding: 12px 16px;
      border: 1px solid #444;
      border-radius: 8px;
      font-family: 'Inter', sans-serif;
      font-size: 1rem;
      background-color: #1a1a1a;
      color: #ffffff;
      transition: all 0.3s ease;
    }

    .form-control:focus {
      outline: none;
      border-color: #00ff88;
      box-shadow: 0 0 0 3px rgba(0, 255, 136, 0.1);
    }

    .form-control::placeholder {
      color: #888;
    }

    textarea.form-control {
      min-height: 100px;
      resize: vertical;
    }

    .form-actions {
      display: flex;
      gap: 16px;
      margin-top: 32px;
    }

    .image-preview {
      width: 200px;
      height: 200px;
      border-radius: 8px;
      overflow: hidden;
      background-color: #1a1a1a;
      border: 2px dashed #444;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-top: 10px;
    }

    .image-preview img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .image-preview-placeholder {
      color: #888;
      text-align: center;
      padding: 20px;
    }

    .image-preview-placeholder i {
      font-size: 2rem;
      margin-bottom: 10px;
      display: block;
    }

    .categories-list {
      margin-top: 20px;
    }

    .categories-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 10px;
    }

    .category-tag {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 6px 12px;
      background-color: #333;
      border-radius: 8px;
      font-size: 0.875rem;
      font-weight: 500;
      color: #e0e0e0;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .category-tag:hover {
      background-color: #444;
    }

    .category-tag.selected {
      background-color: #00ff88;
      color: #1a1a1a;
    }

    .category-tag i {
      color: #00ff88;
      font-size: 0.75rem;
    }

    .category-tag.selected i {
      color: #1a1a1a;
    }

    .products-summary {
      margin-top: 30px;
      padding-top: 20px;
      border-top: 1px solid #444;
    }

    .summary-item {
      display: flex;
      justify-content: space-between;
      padding: 8px 0;
      border-bottom: 1px solid #333;
    }

    .summary-label {
      color: #b0b0b0;
    }

    .summary-value {
      font-weight: 600;
      color: #ffffff;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 12px 24px;
      border-radius: 8px;
      border: none;
      font-family: 'Inter', sans-serif;
      font-weight: 600;
      font-size: 0.9375rem;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
    }

    .btn-primary {
      background-color: #00ff88;
      color: #1a1a1a;
    }

    .btn-primary:hover {
      opacity: 0.9;
      transform: translateY(-2px);
    }

    .btn-secondary {
      background-color: transparent;
      color: #e0e0e0;
      border: 1px solid #444;
    }

    .btn-secondary:hover {
      border-color: #00ff88;
      color: #00ff88;
    }

    .notification {
      position: fixed;
      top: 100px;
      right: 24px;
      background-color: #00ff88;
      color: #1a1a1a;
      padding: 12px 20px;
      border-radius: 8px;
      box-shadow: 0 4px 16px rgba(0,0,0,0.4);
      z-index: 9999;
      animation: slideIn 0.3s ease;
      font-weight: 500;
      max-width: 300px;
    }

    @keyframes slideIn {
      from { transform: translateX(100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }
  </style>
</head>
<body>
<!-- Admin Header -->
<header class="admin-header">
  <div class="container header-container">
    <a href="index.html" class="logo">
      SKATE<span>OR DIE.</span>
    </a>

    <nav class="nav">
      <ul class="nav-links">
        <li><a href="index.html" class="nav-link">Home</a></li>
        <li><a href="shop.html" class="nav-link">Shop</a></li>
        <li><a href="admin.html" class="nav-link active">Admin</a></li>
      </ul>
    </nav>
  </div>
</header>

<!-- Admin Hero -->
<section class="admin-hero">
  <div class="container">
    <h1 class="display-md">Admin Panel</h1>
    <p class="text-lg opacity-75">
      Manage your store products and categories
    </p>
  </div>
</section>

<!-- Admin Panel -->
<section class="admin-panel-section">
  <div class="container">
    <div class="admin-tabs">
      <button class="admin-tab active" onclick="showAdminTab('addProduct')">Add Product</button>
      <button class="admin-tab" onclick="showAdminTab('addCategory')">Add Category</button>
      <button class="admin-tab" onclick="showAdminTab('manage')">Manage</button>
    </div>

    <div class="admin-content">
      <!-- Add Product Form -->
      <div class="admin-form active" id="addProductForm">
        <h3 class="mb-4">Add New Product</h3>
        <form id="productForm" onsubmit="addNewProduct(event)">
          <div class="form-row">
            <div class="form-group">
              <label class="form-label">Product Name *</label>
              <input type="text" class="form-control" id="productName" required>
            </div>

            <div class="form-group">
              <label class="form-label">Price ($) *</label>
              <input type="number" class="form-control" id="productPrice" min="0" step="0.01" required>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label class="form-label">Category *</label>
              <div class="categories-tags" id="categorySelection">
                <!-- Categories will be loaded here -->
              </div>
              <input type="hidden" id="selectedCategory" required>
            </div>

            <div class="form-group">
              <label class="form-label">Badge</label>
              <input type="text" class="form-control" id="productBadge" placeholder="e.g., New, Bestseller, Limited">
            </div>
          </div>

          <div class="form-group">
            <label class="form-label">Description</label>
            <textarea class="form-control" id="productDescription" rows="3"></textarea>
          </div>

          <div class="form-group">
            <label class="form-label">Image URL *</label>
            <input type="url" class="form-control" id="productImageUrl"
                   placeholder="https://example.com/image.jpg" required>

            <div class="image-preview" id="imagePreview">
              <div class="image-preview-placeholder">
                <i class="fas fa-image"></i>
                <span>Image preview will appear here</span>
              </div>
            </div>
          </div>

          <div class="form-group">
            <label class="form-label">Available Colors (comma separated)</label>
            <input type="text" class="form-control" id="productColors"
                   placeholder="Black, White, Gray, Navy">
          </div>

          <div class="form-actions">
            <button type="submit" class="btn btn-primary">
              <i class="fas fa-plus"></i>
              Add Product
            </button>
            <button type="button" class="btn btn-secondary" onclick="resetProductForm()">
              <i class="fas fa-redo"></i>
              Reset Form
            </button>
          </div>
        </form>

        <div class="products-summary">
          <h4 class="mb-3">Products Summary</h4>
          <div class="summary-item">
            <span class="summary-label">Total Products:</span>
            <span class="summary-value" id="totalProducts">0</span>
          </div>
          <div class="summary-item">
            <span class="summary-label">Products by Category:</span>
            <span class="summary-value" id="categorySummary">-</span>
          </div>
        </div>
      </div>

      <!-- Add Category Form -->
      <div class="admin-form" id="addCategoryForm">
        <h3 class="mb-4">Add New Category</h3>
        <form id="categoryForm" onsubmit="addNewCategory(event)">
          <div class="form-group">
            <label class="form-label">Category Name *</label>
            <input type="text" class="form-control" id="categoryName" required>
          </div>

          <div class="form-actions">
            <button type="submit" class="btn btn-primary">
              <i class="fas fa-plus"></i>
              Add Category
            </button>
            <button type="button" class="btn btn-secondary" onclick="resetCategoryForm()">
              <i class="fas fa-redo"></i>
              Reset
            </button>
          </div>
        </form>

        <div class="categories-list mt-4">
          <h4 class="mb-3">Existing Categories</h4>
          <div class="categories-tags" id="existingCategories">
            <!-- Categories will be loaded here -->
          </div>
        </div>
      </div>

      <!-- Manage Products -->
      <div class="admin-form" id="manageForm">
        <h3 class="mb-4">Manage Products</h3>
        <div class="products-summary">
          <div class="summary-item">
            <span class="summary-label">Total Products in Database:</span>
            <span class="summary-value" id="dbTotalProducts">0</span>
          </div>
          <div class="summary-item">
            <span class="summary-label">Last Added:</span>
            <span class="summary-value" id="lastAdded">-</span>
          </div>
        </div>

        <div class="form-actions mt-4">
          <button type="button" class="btn btn-secondary" onclick="exportProducts()">
            <i class="fas fa-download"></i>
            Export Products
          </button>
          <button type="button" class="btn btn-secondary" onclick="clearLocalStorage()">
            <i class="fas fa-trash"></i>
            Clear Data
          </button>
          <button type="button" class="btn btn-secondary" onclick="restoreDefaultProducts()" style="margin-left: 10px;">
            <i class="fas fa-undo"></i>
            Restore Defaults
          </button>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- JavaScript -->
<script>
  // Product Data - Load from localStorage or use default
  let products = [];
  let categories = ['Hoodies', 'Pants', 'Footwear', 'Accessories', 'T-Shirts', 'Jackets', 'Skateboards'];
  let selectedCategory = '';

  // Initialize admin panel
  document.addEventListener('DOMContentLoaded', function() {
    loadProductsFromStorage();
    loadCategories();
    updateProductSummary();
    setupImagePreview();
    loadExistingCategoriesList();
  });

  // ===== STORAGE FUNCTIONS =====

  function loadProductsFromStorage() {
    const savedProducts = localStorage.getItem('skateordie_products');
    const savedCategories = localStorage.getItem('skateordie_categories');

    if (savedProducts) {
      products = JSON.parse(savedProducts);
    }

    if (savedCategories) {
      const storedCategories = JSON.parse(savedCategories);
      storedCategories.forEach(cat => {
        if (!categories.includes(cat)) {
          categories.push(cat);
        }
      });
    }
  }

  function saveProductsToStorage() {
    localStorage.setItem('skateordie_products', JSON.stringify(products));
    localStorage.setItem('skateordie_categories', JSON.stringify(categories));
  }

  // ===== ADMIN UI FUNCTIONS =====

  function showAdminTab(tabName) {
    // Hide all forms
    document.querySelectorAll('.admin-form').forEach(form => {
      form.classList.remove('active');
    });

    // Remove active class from all tabs
    document.querySelectorAll('.admin-tab').forEach(tab => {
      tab.classList.remove('active');
    });

    // Show selected form and activate tab
    document.getElementById(`${tabName}Form`).classList.add('active');
    event.target.classList.add('active');
  }

  function loadCategories() {
    const container = document.getElementById('categorySelection');

    if (!container) return;

    container.innerHTML = categories.map(category => `
      <div class="category-tag" onclick="selectCategory('${category}')"
           data-category="${category}">
        <i class="fas fa-tag"></i>
        <span>${category}</span>
      </div>
    `).join('');
  }

  function selectCategory(category) {
    selectedCategory = category;

    // Update UI
    document.querySelectorAll('.category-tag').forEach(tag => {
      tag.classList.remove('selected');
      if (tag.dataset.category === category) {
        tag.classList.add('selected');
      }
    });

    document.getElementById('selectedCategory').value = category;
  }

  function setupImagePreview() {
    const imageUrlInput = document.getElementById('productImageUrl');
    const preview = document.getElementById('imagePreview');

    if (imageUrlInput && preview) {
      imageUrlInput.addEventListener('input', function() {
        const url = this.value.trim();

        if (url && (url.startsWith('http://') || url.startsWith('https://'))) {
          preview.innerHTML = `<img src="${url}" alt="Product preview" onerror="this.onerror=null; this.parentElement.innerHTML='<div class=\'image-preview-placeholder\'><i class=\'fas fa-exclamation-circle\'></i><span>Image not found</span></div>';">`;
        } else if (url) {
          preview.innerHTML = '<div class="image-preview-placeholder"><i class="fas fa-exclamation-circle"></i><span>Invalid URL</span></div>';
        } else {
          preview.innerHTML = '<div class="image-preview-placeholder"><i class="fas fa-image"></i><span>Image preview will appear here</span></div>';
        }
      });
    }
  }

  // ===== PRODUCT MANAGEMENT =====

  function addNewProduct(event) {
    event.preventDefault();

    // Get form values
    const name = document.getElementById('productName').value.trim();
    const price = parseFloat(document.getElementById('productPrice').value);
    const category = document.getElementById('selectedCategory').value;
    const badge = document.getElementById('productBadge').value.trim();
    const description = document.getElementById('productDescription').value.trim();
    const imageUrl = document.getElementById('productImageUrl').value.trim();
    const colors = document.getElementById('productColors').value
      .split(',')
      .map(color => color.trim())
      .filter(color => color.length > 0);

    // Validation
    if (!name || !price || !category || !imageUrl) {
      showNotification('Please fill all required fields', 'error');
      return;
    }

    if (price <= 0) {
      showNotification('Price must be greater than 0', 'error');
      return;
    }

    // Generate new product ID
    const newId = products.length > 0
      ? Math.max(...products.map(p => p.id)) + 1
      : 1;

    // Create new product object
    const newProduct = {
      id: newId,
      name: name,
      price: price,
      category: category,
      imageUrl: imageUrl,
      badge: badge || null,
      colors: colors.length > 0 ? colors : ['Black', 'White', 'Gray'],
      addedDate: new Date().toISOString()
    };

    // Add to products array
    products.push(newProduct);

    // Save to localStorage
    saveProductsToStorage();

    // Update UI
    updateProductSummary();

    // Add to categories if new
    if (!categories.includes(category)) {
      categories.push(category);
      loadCategories();
      loadExistingCategoriesList();
    }

    // Reset form
    resetProductForm();

    // Show notification
    showNotification(`Product "${name}" added successfully!`, 'success');
  }

  function addNewCategory(event) {
    event.preventDefault();

    const categoryName = document.getElementById('categoryName').value.trim();

    if (!categoryName) {
      showNotification('Please enter a category name', 'error');
      return;
    }

    if (categories.includes(categoryName)) {
      showNotification('Category already exists', 'error');
      return;
    }

    // Add to categories
    categories.push(categoryName);

    // Save to localStorage
    saveProductsToStorage();

    // Update UI
    loadCategories();
    loadExistingCategoriesList();

    // Reset form
    resetCategoryForm();

    showNotification(`Category "${categoryName}" added successfully!`, 'success');
  }

  function loadExistingCategoriesList() {
    const container = document.getElementById('existingCategories');

    if (!container) return;

    container.innerHTML = categories.map(category => `
      <div class="category-tag">
        <i class="fas fa-tag"></i>
        <span>${category}</span>
      </div>
    `).join('');
  }

  function updateProductSummary() {
    document.getElementById('totalProducts').textContent = products.length;
    document.getElementById('dbTotalProducts').textContent = products.length;

    // Count by category
    const byCategory = {};
    products.forEach(product => {
      byCategory[product.category] = (byCategory[product.category] || 0) + 1;
    });

    const summary = Object.entries(byCategory)
      .map(([cat, count]) => `${cat}: ${count}`)
      .join(', ');

    document.getElementById('categorySummary').textContent = summary || '-';

    // Last added product
    if (products.length > 0) {
      const lastProduct = products[products.length - 1];
      document.getElementById('lastAdded').textContent =
        `${lastProduct.name} (${lastProduct.category})`;
    } else {
      document.getElementById('lastAdded').textContent = '-';
    }
  }

  // ===== FORM RESET FUNCTIONS =====

  function resetProductForm() {
    document.getElementById('productForm').reset();
    document.getElementById('imagePreview').innerHTML =
      '<div class="image-preview-placeholder"><i class="fas fa-image"></i><span>Image preview will appear here</span></div>';

    // Clear category selection
    selectedCategory = '';
    document.querySelectorAll('.category-tag').forEach(tag => {
      tag.classList.remove('selected');
    });
    document.getElementById('selectedCategory').value = '';
  }

  function resetCategoryForm() {
    document.getElementById('categoryForm').reset();
  }

  // ===== DATA MANAGEMENT =====

  function exportProducts() {
    const dataStr = JSON.stringify(products, null, 2);
    const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);

    const exportFileDefaultName = `skateordie-products-${new Date().toISOString().split('T')[0]}.json`;

    const linkElement = document.createElement('a');
    linkElement.setAttribute('href', dataUri);
    linkElement.setAttribute('download', exportFileDefaultName);
    document.body.appendChild(linkElement);
    linkElement.click();
    document.body.removeChild(linkElement);

    showNotification('Products exported successfully', 'success');
  }

  function clearLocalStorage() {
    if (confirm('Are you sure you want to clear all product data? This cannot be undone.')) {
      localStorage.removeItem('skateordie_products');
      localStorage.removeItem('skateordie_categories');

      // Reset categories
      categories = ['Hoodies', 'Pants', 'Footwear', 'Accessories', 'T-Shirts', 'Jackets', 'Skateboards'];

      // Reset products
      products = [];

      // Update UI
      loadCategories();
      loadExistingCategoriesList();
      updateProductSummary();

      showNotification('All data cleared successfully', 'success');
    }
  }

  function restoreDefaultProducts() {
    if (confirm('Restore default products?')) {
      // Reload the page
      location.reload();
    }
  }

  // ===== UTILITY FUNCTIONS =====

  function showNotification(message, type = 'success') {
    const notification = document.createElement('div');
    notification.className = 'notification';
    notification.textContent = message;

    if (type === 'error') {
      notification.style.backgroundColor = '#ff4444';
    }

    document.body.appendChild(notification);

    // Remove after 3 seconds
    setTimeout(() => {
      notification.style.animation = 'slideIn 0.3s ease reverse';
      setTimeout(() => {
        if (document.body.contains(notification)) {
          document.body.removeChild(notification);
        }
      }, 300);
    }, 3000);
  }
</script>
</body>
</html>
